{% load i18n %}

{% with request.resolver_match.view_name as view_name and request.resolver_match.namespace as namespace %}

<nav class="bg-white shadow-sm border-b z-40" x-data="{ mobileMenuOpen: false }">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-16">
      <div class="flex">
        {% comment %} Logo {% endcomment %}
        <div class="flex-shrink-0 flex items-center md:mr-6">
          <a href="/" class="flex items-center text-orange-500">
            <svg class="fill-current h-8 w-8 mr-2" viewbox="0 0 180 205"><path d="M83 199.78C72.2 191.8 63.73 177 61.5 162.27c-.55-3.72-.42-4.57.67-4.18.75.27 7.26 2.07 14.47 4l13.1 3.52 11.75-3.01c6.47-1.66 12.58-3.45 13.59-4 2.97-1.58 3.14-1.25 2.4 4.78-1.79 14.67-9 27.71-20.21 36.5-3.34 2.61-6.44 4.74-6.9 4.73-.46 0-3.77-2.18-7.36-4.83zm-67.64-40.66a68.23 68.23 0 01-10.77-3.37L0 153.72l.59-4.3c1.78-13.09 4.43-20.21 10.9-29.28 5.05-7.08 15.36-16.38 15.9-14.34.35 1.32 2.1 8.16 5.41 21.14 1.68 6.6 2.07 7.14 11.99 16.81 5.64 5.5 10.25 10.19 10.25 10.42 0 1-7.94 4.3-12.8 5.33-6.95 1.48-19.15 1.3-26.88-.38zm119.21-.1c-3.28-.8-6.95-2.1-8.16-2.89-2.16-1.41-1.98-1.65 8.54-11.72 9.6-9.2 10.82-10.75 11.5-14.72a58.48 58.48 0 012.74-9.44 52.28 52.28 0 002.66-10.33l.69-5.33 6.15 4.98c10.96 8.88 18.94 23.86 20.1 37.72l.5 6.16-4.23 2.17c-9.38 4.78-28.21 6.37-40.49 3.4zM21.6 94.57C9.56 84.63 1.04 67.75 1.04 53.88c0-4.14.18-4.4 4.28-6.16 12.6-5.4 35.1-5.6 47.53-.4l3.5 1.46-8.41 8.48c-4.62 4.66-9.86 9.39-11.65 10.5-2.84 1.77-3.25 2.57-3.25 6.27 0 2.34-1.13 7.55-2.5 11.6-1.38 4.04-2.5 8.62-2.5 10.17 0 1.56-.35 2.83-.77 2.83-.42 0-2.98-1.83-5.68-4.06zm130.45 1.03c0-1.67-.9-5.72-2.01-9-1.1-3.29-2.48-8.1-3.05-10.72-.86-3.93-2.37-6.14-8.74-12.75-4.24-4.4-9.23-9.2-11.1-10.65l-3.4-2.64 3.1-1.6c5.5-2.85 14.4-4.61 23.27-4.61 10.68 0 17.65 1.27 24.7 4.5l5.4 2.47-.63 4.26c-2 13.43-5.32 22.15-11.6 30.46-3.5 4.63-13.46 13.3-15.28 13.3-.36 0-.66-1.36-.66-3.02zM62.42 41.05c1.86-15.82 10.16-29.5 23.44-38.64 4.02-2.77 4.6-2.9 7.02-1.65 4.7 2.42 15.57 14.2 18.82 20.37a67.53 67.53 0 016.78 21.37c.56 3.92.44 4.29-1.16 3.6-.98-.43-6.5-2.04-12.28-3.58-5.78-1.54-11.3-3.28-12.27-3.87a3.42 3.42 0 00-3.63-.07c-1.03.54-6 1.91-11.06 3.04-5.06 1.13-10.8 2.72-12.76 3.53l-3.56 1.5.66-5.6z"/></svg>
            <span class="font-bree text-xl mb-1">ecobasa.org</span>
          </a>
        </div>
        {% comment %} Desktop Menu {% endcomment %}
        <div class="hidden sm:ml-6 sm:flex">
          <a href="/" class="inline-flex items-center px-1 pt-1 border-b-2 {% if view_name == "homepage:homepage" %}border-orange-500 text-gray-900{% else %}border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300{% endif %} text-sm font-medium leading-5  focus:outline-none focus:border-orange-500 transition duration-150 ease-in-out">
            {% trans "Homepage" %}
          </a>
          <a href="{% url "gifting:search" %}" class="{% if namespace == "gifting" %}border-orange-500 text-gray-900{% else %}border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300{% endif %} ml-8 inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out">
            {% trans "Free Market" %}
          </a>
          <a href="#" class="ml-8 inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out">
            {% trans "Communities" %}
          </a>
        </div>
      </div>
      {% if user.is_authenticated %}
        <div class="hidden sm:ml-6 sm:flex sm:items-center">
          {% comment %} Notification Bell {% endcomment %}
          <button class="p-1 border-2 border-transparent text-gray-400 rounded-full hover:text-gray-500 focus:outline-none focus:text-gray-500 focus:bg-gray-100 transition duration-150 ease-in-out" aria-label="Notifications">
            <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
          </button>

          {% comment %} Profile dropdown {% endcomment %}
          <div class="ml-3 relative" x-data="{ open: false }">
            <div>
              <button @click="open = true" class="flex text-sm border-2 border-transparent rounded-full focus:outline-none focus:border-gray-300 transition duration-150 ease-in-out" id="user-menu" aria-label="User menu" aria-haspopup="true">
                <img class="h-8 w-8 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
              </button>
            </div>
            {% comment %} dropdown {% endcomment %}
            <div x-show="open" @click.away="open = false"
                  x-transition:enter="transition ease-out duration-200"
                  x-transition:enter-start="opacity-0 transform scale-95"
                  x-transition:enter-end="opacity-100 transform scale-100"
                  x-transition:leave="transition ease-in duration-75"
                  x-transition:leave-start="opacity-100 transform scale-100"
                  x-transition:leave-end="opacity-0 transform scale-95"
                  class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg z-40">
              <div class="py-1 rounded-md bg-white shadow-xs">
                <a href="#" class="block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out">Your Profile</a>
                <a href="#" class="block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out">Settings</a>
                <form action="{% url "users:logout" %}" method="POST">
                  {% csrf_token %}
                  <button type="submit" class="w-full text-left block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out">{% trans "Logout" %}</a>
                </form>
              </div>
            </div>
          </div>
        </div>
      {% else %}
        {% comment %} Login button {% endcomment %}
        <div class="flex-shrink-0 hidden sm:ml-6 sm:flex sm:items-center">
          <a href="{% url "users:login" %}?next={{ request.path }}" class="relative inline-flex items-center px-4 py-2 border border-transparent border-orange-500 text-sm leading-5 font-medium rounded-md text-orange-700 hover:text-white shadow-sm hover:bg-orange-500 focus:outline-none focus:border-orange-700 focus:shadow-outline-orange active:bg-orange-700 transition ease-in-out duration-150">
            <span>{% trans "Login" %}</span>
          </a>
        </div>
      {% endif %}
      <div class="-mr-2 flex items-center sm:hidden">
        {% comment %} mobile menu button {% endcomment %}
        <button @click="mobileMenuOpen = !mobileMenuOpen" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 focus:text-gray-500 transition duration-150 ease-in-out">
          <svg x-show="!mobileMenuOpen" class="block h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <svg x-show="mobileMenuOpen" class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  {% comment %} mobile menu {% endcomment %}
  <div x-show="mobileMenuOpen"
      x-transition:enter="transition ease-out duration-200"
      x-transition:enter-start="opacity-0 transform scale-y-95"
      x-transition:enter-end="opacity-100 transform scale-y-100"
      x-transition:leave="transition ease-in duration-75"
      x-transition:leave-start="opacity-100 transform scale-y-100"
      x-transition:leave-end="opacity-0 transform scale-y-95"
      class="sm:hidden origin-top-right">
    <div class="pt-2 pb-3">
      <a href="{% url "homepage:homepage" %}" class="block pl-3 pr-4 py-2 border-l-4 border-transparent {% if view_name == "homepage:homepage" %}border-orange-500 text-orange-700 bg-orange-50 focus:text-orange-800 focus:bg-orange-100 focus:border-orange-700{% else %}text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300{% endif %} text-base font-medium focus:outline-none transition duration-150 ease-in-out">{% trans "Homepage" %}</a>
      <a href="{% url "gifting:search" %}" class="mt-1 block pl-3 pr-4 py-2 border-l-4 border-transparent {% if namespace == "gifting" %}border-orange-500 text-orange-700 bg-orange-50 focus:text-orange-800 focus:bg-orange-100 focus:border-orange-700{% else %}text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300{% endif %} text-base font-medium focus:outline-none transition duration-150 ease-in-out">{% trans "Gifting" %}</a>
      <a href="#" class="mt-1 block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out">{% trans "Communities" %}</a>
    </div>

    {% if user.is_authenticated %}
      <div class="pt-4 pb-3 border-t border-gray-200">
        <div class="flex items-center px-4">
          <div class="flex-shrink-0">
            <img class="h-10 w-10 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
          </div>
          <div class="ml-3">
            <div class="text-base font-medium leading-6 text-gray-800">{{ user.name }}</div>
            <div class="text-sm font-medium leading-5 text-gray-500">{{ user.email }}</div>
          </div>
        </div>
        <div class="mt-3" role="menu" aria-orientation="vertical" aria-labelledby="user-menu">
          <a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:text-gray-800 focus:bg-gray-100 transition duration-150 ease-in-out" role="menuitem">Your Profile</a>
          <a href="#" class="mt-1 block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:text-gray-800 focus:bg-gray-100 transition duration-150 ease-in-out" role="menuitem">Settings</a>
          <a href="{% url "users:logout" %}" class="mt-1 block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:text-gray-800 focus:bg-gray-100 transition duration-150 ease-in-out" role="menuitem">{% trans "Logout" %}</a>
        </div>
      </div>
    {% endif %}
  </div>
</nav>

{% endwith %}
